# May 12, 2021
The day was really hectic so I was quite tired. Even though I was able to still get something done. I just basically tried to follow the tutorial and ensure that the code works.

# Bug from [06](06.md)
What we have at the moment
```javascript
const handleSubmit = async (e) => {
    e.preventDefault()

    ....

    try{
        login(emailRef.current.value, passwordRef.current.value)
    }catch{

    }
}
```

Correct thing
```javascript
const handleSubmit = async (e) => {
    e.preventDefault()

    ....

    try{
        await login(emailRef.current.value, passwordRef.current.value)
    }catch{

    }
}
```
I didn't add await before the login function

# New thing learnt

## Updating user's email and their password

- Create a function in AuthContext.js to update both and pass their values to the AuthContext.Provider

```javascript
...

const updateUserEmail = (email) => {
    return currentUser.updateEmail
}

const updateUserPassword = (password) => {
    return currentUser.updatePassword(password)
}
...

const value = {..., updateUserEmail, updateUserPassword}

return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>
...
```

- Usage within a component, create a method that implements both but this time around, we will be using Promise.all to process the two requests. Here is what the code to process updating both information would look like

```javascript
const {currentUser, updateUserEmail, updateUserPassword} = useAuth

const handleSubmit = async (e) => {
    e.preventDefault()
    setLoading(true)
    if(passwordRef.current.value !== passwordConfirmationRef.current.value){
        setError("Passwords must match")
    }

    const promises = []

    if(emailRef.current.value !== currentUser.email){
        promises.push(updateUserEmail(emailRef.current.value))
    }

    if(passwordRef.current.value !== ""){
        promises.push(updateUserPassword(passwordRef.current.value))
    }

    Promise.all(promises).then(()=> {
        history.push("/")
    }).catch(()=> {
        setError("Unable to update profile")
    }).finally(()=>{
        setLoading(false)
    })
}
```



[Back to journal](README.md)
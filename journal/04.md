# May 6, 2021
The day was really hectic so I was quite tired. Even though I was able to still get something done. I just basically tried to follow the tutorial and ensure that the code works.

# Bug from [01](01.md)
What we have at the moment
```javascript
const app = firebase({
    ...configuration_details
})
```

Correct thing
```
const app = firebase.intializeApp({
    ...configuration_details
})
```

# New thing learnt

## State Management with Context
It seems the landscape of the global state management keeps changing and this particular approach looks quite simple

- Create a file to hold your context (e.g AuthContext.js)
- Create AuthContext
```javascript
const AuthContext = React.createContext()
```
- Create Provider
```
const AuthProvider = ({children}) => <AuthContext.Provider>{children}</AuthContext.Provider>
```
- Create an value object and pass it to <AuthContext.Provider>
```
const value = {
    currentUser
}
const AuthProvider = ({children}) => <AuthContext.Provider value={value}>{children}</AuthContext.Provider>
```
- Create a hook to access the context
```
export const useAuth = () => useContext(AuthContext)
```

## Signup and send data to context
- Import auth from firebase
```
import {auth} from ".../firebase"
```
- Create the Signup function
```
const signup = (email, password) => auth.createUserWithEmailAndPassword(email, password)
```
- Add the signup function to value passed to the <AuthContext.Provider>
```
const value = {
    currentUser,
    signup
}
```
- On successful signup, get the user's data
```
const [currentUser, setCurrentUser] = useState()

useEffect(()=> {
    const unsubscribe = auth.onAuthStateChanged((user)=>{
        setCurrentUser(user)
    })

    return unsubscribe
}, [])
```

## What the final code would look like
```
import React, {useState, useEffect, useContext} from "react"
import {auth} from ".../firebase"

const AuthContext = React.createContext()

const useAuth = () => useContext(AuthContext)

export const AuthProvider = ({children}) => {
const [currentUser, setCurrentUser] = useState("")

const signup = (email, password) => auth.createUserWithEmailAndPassword(email, password)

useEffect(()=>{
    const unsubscribe = auth.onAuthStateChanged((user)=> {
        setCurrentUser(user)
    })

    return unsubscribe
},[])

const value = {currentUser, signup}
    return(
        <AuthContext.Provider value={value}>
        {children}
        </AuthContext.Provider>)
    }
```
- Usage within a compononent
```
import {useAuth} from "../path/to/AuthContext"

const Component = () => {
    const [currentuser, signup] = useAuth()

    {/* Carryout actions */}
    return <></>
}
```

[Back to journal](README.md)